<!--
A comment describing this element

Example:

    <my-elem></my-elem>

Example:

    <my-elem>
      <h2>Hello my-elem</h2>
    </my-elem>

@demo demo/index.html
-->
<dom-module id="login-page">
    <template>
        <style>
        :host {
            @apply(--layout-vertical);
            @apply(--layout-center-center);
        }
        form{
          width: 70%;
        }
        </style>
        <firebase-auth location="https://deearcodes.firebaseio.com/" on-login="login" provider="password" id="firebaseAuth">
        </firebase-auth>
        <form is="iron-form" id="form" method="post">
            <paper-input label="Email" type="email" name="email"></paper-input>
            <paper-input type="password" label="Password" name="password"></paper-input>
            <paper-button raised on-tap="sendForm">Inciar sesion</paper-button>
        </form>
    </template>
    <script>
    Polymer({
        is: 'login-page',
        sendForm: function(event) {
            event.preventDefault();
            let data = this.$.form.serialize();
            this.$.firebaseAuth.login({
                "email": data.email,
                "password": data.password
            });
        },
        /**
         * Log In event from Firebase in charge of lazy loading the <admin-page> Element and setting it's logged flag
         * @param  {Object} event The Event
         * @return {[type]}       [description]
         */
        login: function(event) {
            this.importHref(this.resolveUrl('../admin-page/admin-page.html'), e => {
                const adminPageParentWrapper = Polymer.dom(document).querySelector('.adminPageParentWrapper');
                const adminElement = document.createElement('admin-page');
                Polymer.dom(adminPageParentWrapper).appendChild(adminElement);

                adminElement.set('logged', true);
                // e.target.import is the import document.
            }, e => {
                // loading error
            });

        },
        error: function(event) {
            console.log(event.detail)
        }
    });
    </script>
</dom-module>
